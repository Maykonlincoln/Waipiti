#!/usr/bin/env python3

from enum import Enum, auto

from wapitiCore.net.page import Page
from wapitiCore.net.web import Request

class Level(Enum):
    INFO = auto()
    LOW = auto()
    MEDIUM = auto()
    HIGH = auto()
    CRITICAL = auto()

class Vulnerability:
    """Default class representing a basic Vulnerability.

    The class is intended to be overriden to create vulnerabilities types with
    more specific reporting needs.
    """

    name = "Vulnerability"
    short_name = "vuln"

    # List of upper-case WSTG code, example: "WSTG-INPV-05"
    wstg_codes: "list[str]" = []

    # Short paragraph explaining how the vulnerability works and how it can be
    # exploited.
    description = "This is a generic vulnerability."

    # Multi-line string describing what can be done to fix or reduce the
    # criticity of the vulnerability.
    solution = "There is no known solution"

    # A list of entries of the following format:
    # { "title": "Title", "url": "https://example.com" }
    references = []

    def __init__(self, page: Page, attacked_request: Request, level: Level):
        self.page = page
        self.level = level
        self.attacked_request = attacked_request

    @property
    def info(self) -> str:
        return ""

    def to_html(self):
        pass

    def to_txt(self):
        pass
